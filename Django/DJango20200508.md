# TIL 2020-05-09

## 오늘 배운 내용

---

- Templates 을 확장하는 방법을 알아보았다.

- django의 Form 기능에 대해 알아보았다.

### 템플릿 상속

장고에서 여러번 템플릿 문서를 작성해서 쓰는건 편하지만 만약 head 메타정보가
변경이 되어야한다면 수많은 html문서를 바꿔줘야 할것이다.

이런 번거로운 작업을 줄이고자 해서 템플릿 상속이 존재한다.

```{.html}

base.html

<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    {% load static %}
    <link rel="stylesheet" href="{% static "fcuser/style.css" %}">
  </head>
  <body>
    <section class="Container">
      {% block contents %}
      {% endblock %}
    </section>
  </body>
</html>


```

결과부터 말하자면 이 base.html 라는 템플릿에 존재하는
{% block contents %} {% endblock %} 구문 안은
여러 템플릿이 존재하며 그 각각의 템플릿들이 base.html 안에서 렌더링 된다.

즉 템플릿을 상속받을 수 있다는 것인데

상속할 템플릿의 최상단에
{% extends 'base.html' %} 이렇게 extends 를 하면 상속을 한다는 말이다.

```html
{% block contents %}
<h1 class="form__title">로그인</h1>
{% endblock %}
```

base 에서 지정한 block contens를 상속할 html에서도 써주면
안쪽 요소들이 전부 base.html에서 사용할 수 있게 되는것이다.

이러면 수많은 문서가 생겨도 쉽게 수정하고 제어할 수 있는것이다.

### Form 기능

```python

from django import forms


class LoginForm(forms.Form):
    username = forms.CharField(max_length=32, label="사용자이름")
    password = forms.CharField(widget=forms.PasswordInput, label="비밀번호")


```

이전에 직접 작성한 폼이 아닌 장고에서 지원하는 폼을 이용해
실제 생겨나는 필드개수에 따라 자동으로 입력 폼을 그려준다.

그리고 views 로 돌아와 이 Form 을 연결해준다.

```python

from .forms import LoginForm

def login(request):
    if request.method == "POST":
        form = LoginForm(request.POST)
        if form.is_valid():  # 검증
    else:  
        form = LoginForm()
    return render(request, 'login.html', {"form": form})

```

이렇게 연결시켜서 POST방식일 경우 POST 데이터값을 받아 LoginForm에 저장한다.
form이 가지는 메서드중 is_valid()로 유효성 검증을 하고 이후 내용을 실행한다.

POST값이 없으면 빈값의 폼을 렌더링한다.

그리고 {"form": form} 이 form은 템플릿에 전송할 각각의 테이블이다.

```html

 <h1 class="form__title">로그인</h1>
        <fieldset class="form__field">
          <form method="POST" action=".">
            {% csrf_token %}
            <p class="alert_title">{{ error }}</p>
            {% for field in form %}
            <div class="form__group">
            <label for="{{ field.id_for_label }}">{{ field.label }}</label>
            <input type="{{ field.field.widget.input_type }}" class="form-control" id="{{ field.id_for_label }}" placeholder="{{ field.label }}" name="{{ field.name }}">
            </div>
            {% if field.errors %}
            <span style="color:red;">{{ field.errors }}</span>
            {% endif %}
            {% endfor %}
            <legend>로그인</legend>
            <button type="submit" class="btn btn-default">로그인</button>
          </form>
        </fieldset>

```

잘 보면 {% for field in form %} {% %} 이런 태그로 for문이 감싸져있다.
이건 템플릿 태그로 장고에서 html을 보여주는 하나의 문법이라고 생각된다.

field 변수에 form을 넣어 반복을 하였고
결과적으로 form 안에 있는 테이블 개수에 따라 input값을 만들어주고 있다.

default 값은 꾸며줄 수 없는듯.

그리고 {{ field.id_for_label }} 과 같이 lable 이름을 주거나
input 타입을 지정해주거나 하는 이 변수들이 form이 하는 기능들인것이다.

if문도 들어갈 수 있다.

field.errors를 통해 전송할 값이 하나라도 빠지면 장고에서
자동으로 error 메시지를 출력해준다.
